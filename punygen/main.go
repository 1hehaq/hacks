package main

import (
	"bufio"
	"flag"
	"fmt"
	"os"
	"strings"

	"golang.org/x/net/idna"
)

var homoglyphs = map[rune][]rune{
	'a': {'Ã ', 'Ã¡', 'Ã¢', 'Ã£', 'Ã¤', 'Ã¥', 'É‘', 'Ð', 'Î‘', 'áŽª', 'ï¼¡', 'ð”„', 'ð•¬', 'ð’œ', 'ð€', 'ð´', 'ð˜ˆ', 'ð™°', 'ð– ', 'ð—”', 'ð˜¼', 'ðš¨', 'ð‘¨', 'â“', 'â’¶', 'ðŸ…', 'ðŸ…°', 'ð”ž', 'ð–†', 'ð’¶', 'ð—®', 'ð˜¢', 'Ä', 'Äƒ', 'Ä…', 'Èƒ', 'È§', 'áº¡', 'áº£', 'áº¥', 'áº§', 'áº©', 'áº«', 'áº­', 'áº¯', 'áº±', 'áº³', 'áºµ', 'áº·'},
	'b': {'Ð¬', 'á', 'Æ„', 'á–¯', 'ð›', 'ð‘', 'ð’ƒ', 'ð“«', 'ð”Ÿ', 'ð•“', 'ð–‡', 'ð—¯', 'ð˜£', 'ð™—', 'ðš‹', 'Æ€', 'É“', 'á¸ƒ', 'á¸…', 'á¸‡', 'á¸‚', 'á¸„', 'á¸†', 'Æ', 'Æ‚', 'Æƒ'},
	'c': {'Ï²', 'Ñ', 'Æˆ', 'È¼', 'á¸‰', 'â²¥', 'ðœ', 'ð‘', 'ð’„', 'ð“¬', 'ð” ', 'ð•”', 'ð–ˆ', 'ð—°', 'ð˜¤', 'ð™˜', 'ðšŒ', 'Ä‡', 'Ä‰', 'Ä‹', 'Ä', 'Ã§', 'á¸‰', 'Ä‡', 'Ä†', 'Äˆ', 'ÄŠ', 'ÄŒ', 'Ã‡', 'á¸ˆ', 'È»'},
	'd': {'Ô', 'Õª', 'á§', 'ð', 'ð‘‘', 'ð’…', 'ð“­', 'ð”¡', 'ð••', 'ð–‰', 'ð—±', 'ð˜¥', 'ð™™', 'ðš', 'Ä', 'Ä‘', 'á¸‹', 'á¸', 'á¸', 'á¸‘', 'á¸“', 'ÄŽ', 'Ä', 'á¸Š', 'á¸Œ', 'á¸Ž', 'á¸', 'á¸’', 'ÆŒ', 'É–', 'É—'},
	'e': {'Ðµ', 'Ò½', 'â„®', 'á¸›', 'á¸', 'áº¹', 'Ã©', 'Ã¨', 'Ãª', 'Ã«', 'Ä“', 'Ä—', 'Ä™', 'ðž', 'ð‘’', 'ð’†', 'ð“®', 'ð”¢', 'ð•–', 'ð–Š', 'ð—²', 'ð˜¦', 'ð™š', 'ðšŽ', 'Ä•', 'Ä™', 'Ä—', 'Ä›', 'È…', 'È‡', 'È©', 'á¸•', 'á¸—', 'á¸™', 'á¸›', 'á¸', 'áº½', 'áº»', 'áº¿', 'á»', 'á»ƒ', 'á»…', 'á»‡'},
	'f': {'Ò“', 'ðŸ', 'ð‘“', 'ð’‡', 'ð“¯', 'ð”£', 'ð•—', 'ð–‹', 'ð—³', 'ð˜§', 'ð™›', 'ðš', 'á¸Ÿ', 'á¸ž', 'Æ’', 'Æ‘', 'êœ°'},
	'g': {'É¡', 'Ö', 'ð ', 'ð‘”', 'ð’ˆ', 'ð“°', 'ð”¤', 'ð•˜', 'ð–Œ', 'ð—´', 'ð˜¨', 'ð™œ', 'ðš', 'Ä', 'ÄŸ', 'Ä¡', 'Ä£', 'Ç§', 'Çµ', 'á¸¡', 'Äœ', 'Äž', 'Ä ', 'Ä¢', 'Ç¦', 'Ç´', 'á¸ ', 'Æ', 'É '},
	'h': {'Ò»', 'Õ°', 'á‚', 'â„Ž', 'ð¡', 'ð’‰', 'ð’½', 'ð“±', 'ð”¥', 'ð•™', 'ð–', 'ð—µ', 'ð˜©', 'ð™', 'ðš‘', 'Ä¥', 'Ä§', 'ÈŸ', 'á¸£', 'á¸¥', 'á¸§', 'á¸©', 'á¸«', 'Ä¤', 'Ä¦', 'Èž', 'á¸¢', 'á¸¤', 'á¸¦', 'á¸¨', 'á¸ª', 'Æ•'},
	'i': {'Ñ–', 'É©', 'áŽ¥', 'â… ', 'Ä±', 'Ã­', 'Ã¬', 'Ã®', 'Ã¯', 'Ä«', 'Ä¯', 'ð¢', 'ð‘–', 'ð’Š', 'ð“²', 'ð”¦', 'ð•š', 'ð–Ž', 'ð—¶', 'ð˜ª', 'ð™ž', 'ðš’', 'Ä©', 'Ä­', 'Ä¯', 'Ä±', 'Ç', 'È‰', 'È‹', 'á¸­', 'á¸¯', 'á»‰', 'á»‹', 'Ä°', 'ÃŒ', 'Ã', 'ÃŽ', 'Ã', 'Ä¨', 'Äª', 'Ä¬', 'Ä®', 'Ç', 'Èˆ', 'ÈŠ', 'á¸¬', 'á¸®', 'á»ˆ', 'á»Š'},
	'j': {'Ñ˜', 'Ê', 'Ï³', 'ð£', 'ð‘—', 'ð’‹', 'ð“³', 'ð”§', 'ð•›', 'ð–', 'ð—·', 'ð˜«', 'ð™Ÿ', 'ðš“', 'Äµ', 'Ç°', 'Ä´', 'È·', 'É‰'},
	'k': {'Îº', 'ð¤', 'ð‘˜', 'ð’Œ', 'ð“´', 'ð”¨', 'ð•œ', 'ð–', 'ð—¸', 'ð˜¬', 'ð™ ', 'ðš”', 'Ä·', 'Ç©', 'á¸±', 'á¸³', 'á¸µ', 'Ä¶', 'Ç¨', 'á¸°', 'á¸²', 'á¸´', 'Æ™', 'É¨'},
	'l': {'â…¼', 'Ó', 'Æ–', 'ÊŸ', 'ð¥', 'ð‘™', 'ð’', 'ð“µ', 'ð”©', 'ð•', 'ð–‘', 'ð—¹', 'ð˜­', 'ð™¡', 'ðš•', 'Äº', 'Ä¼', 'Ä¾', 'Å€', 'Å‚', 'á¸·', 'á¸¹', 'á¸»', 'á¸½', 'Ä¹', 'Ä»', 'Ä½', 'Ä¿', 'Å', 'á¸¶', 'á¸¸', 'á¸º', 'á¸¼', 'Æš', 'È´'},
	'm': {'Ð¼', 'á¹ƒ', 'á´', 'ð¦', 'ð‘š', 'ð’Ž', 'ð“¶', 'ð”ª', 'ð•ž', 'ð–’', 'ð—º', 'ð˜®', 'ð™¢', 'ðš–', 'á¸¿', 'á¹', 'á¹', 'á¹ƒ', 'á¸¾', 'á¹€', 'á¹‚', 'É±'},
	'n': {'Õ¸', 'Ð¿', 'Õ¼', 'á¹…', 'á¹‡', 'á¹‹', 'ð§', 'ð‘›', 'ð’', 'ð“·', 'ð”«', 'ð•Ÿ', 'ð–“', 'ð—»', 'ð˜¯', 'ð™£', 'ðš—', 'Å„', 'Å†', 'Åˆ', 'Ç¹', 'á¹…', 'á¹‡', 'á¹‰', 'á¹‹', 'Åƒ', 'Å…', 'Å‡', 'Ç¸', 'á¹„', 'á¹†', 'á¹ˆ', 'á¹Š', 'Æž', 'É²', 'Å‹'},
	'o': {'Î¿', 'Ö…', 'Ó§', 'Ã¶', 'Ã³', 'Ã²', 'Ã´', 'Ãµ', 'Å', 'Å‘', 'â²Ÿ', 'ð¨', 'ð‘œ', 'ð“¸', 'ð”¬', 'ð• ', 'ð–”', 'ð—¼', 'ð˜°', 'ð™¤', 'ðš¬', 'Å', 'Å‘', 'Æ¡', 'Ç’', 'Ç«', 'Ç­', 'Ç¿', 'È', 'È', 'È«', 'È­', 'È¯', 'È±', 'á¹', 'á¹', 'á¹‘', 'á¹“', 'á»', 'á»', 'á»‘', 'á»“', 'á»•', 'á»—', 'á»™', 'á»›', 'á»', 'á»Ÿ', 'á»¡', 'á»£'},
	'p': {'Ñ€', 'Ï', 'â´', 'ð©', 'ð‘', 'ð’‘', 'ð“¹', 'ð”­', 'ð•¡', 'ð–•', 'ð—½', 'ð˜±', 'ð™¥', 'ðš­', 'á¹•', 'á¹—', 'á¹”', 'á¹–', 'Æ¥', 'Æ¿'},
	'q': {'Õ¦', 'Ô›', 'Õ£', 'ðª', 'ð‘ž', 'ð’’', 'ð“º', 'ð”®', 'ð•¢', 'ð––', 'ð—¾', 'ð˜²', 'ð™¦', 'ðšž', 'Ê '},
	'r': {'á´¦', 'Ð³', 'Å™', 'È“', 'á¹›', 'â²…', 'ð«', 'ð‘Ÿ', 'ð’“', 'ð“»', 'ð”¯', 'ð•£', 'ð–—', 'ð—¿', 'ð˜³', 'ð™§', 'ðš›', 'Å•', 'Å—', 'Å™', 'È‘', 'È“', 'á¹™', 'á¹›', 'á¹', 'á¹Ÿ', 'Å”', 'Å–', 'Å˜', 'È', 'È’', 'á¹˜', 'á¹š', 'á¹œ', 'á¹ž', 'É', 'É½', 'É¾', 'É¿'},
	's': {'Ñ•', 'Ê‚', 'á¹¡', 'á¹£', 'ð¬', 'ð‘ ', 'ð’”', 'ð“¼', 'ð”°', 'ð•¤', 'ð–˜', 'ð—Œ', 'ð˜´', 'ð™¨', 'ðšœ', 'Å›', 'Å', 'ÅŸ', 'Å¡', 'È™', 'á¹¡', 'á¹£', 'á¹¥', 'á¹§', 'á¹©', 'Åš', 'Åœ', 'Åž', 'Å ', 'È˜', 'á¹ ', 'á¹¢', 'á¹¤', 'á¹¦', 'á¹¨', 'Æ¨', 'Êƒ'},
	't': {'Ñ‚', 'Ï„', 'á¹­', 'È›', 'â²§', 'ð­', 'ð‘¡', 'ð’•', 'ð“½', 'ð”±', 'ð•¥', 'ð–™', 'ð˜µ', 'ð™©', 'ðš', 'Å£', 'Å¥', 'Å§', 'È›', 'á¹«', 'á¹­', 'á¹¯', 'á¹±', 'Å¢', 'Å¤', 'Å¦', 'Èš', 'á¹ª', 'á¹¬', 'á¹®', 'á¹°', 'Æš', 'Æ­', 'Ê‡'},
	'u': {'Ï…', 'Õ½', 'Ã¼', 'Ãº', 'Ã¹', 'Ã»', 'Å«', 'â²©', 'ð®', 'ð‘¢', 'ð’–', 'ð“¾', 'ð”²', 'ð•¦', 'ð–š', 'ð˜¶', 'ð™ª', 'ðšž', 'Å­', 'Å¯', 'Å±', 'Å³', 'Æ°', 'Ç”', 'Ç–', 'Ç˜', 'Çš', 'Çœ', 'È•', 'È—', 'á¹³', 'á¹µ', 'á¹·', 'á¹¹', 'á¹»', 'á»¥', 'á»§', 'á»©', 'á»«', 'á»­', 'á»¯', 'á»±'},
	'v': {'Î½', 'Ñµ', 'â´¸', 'ð¯', 'ð‘£', 'ð’—', 'ð“¿', 'ð”³', 'ð•§', 'ð–›', 'ð—', 'ð˜·', 'ð™«', 'ðšŸ', 'á¹½', 'á¹¿', 'á¹¼', 'á¹¾', 'Ê‹', 'ÊŒ'},
	'w': {'Ô', 'Õ¡', 'Ñ¡', 'â²±', 'ð°', 'ð‘¤', 'ð’˜', 'ð”€', 'ð”´', 'ð•¨', 'ð–œ', 'ð—', 'ð˜¸', 'ð™¬', 'ðš ', 'Åµ', 'áº', 'áºƒ', 'áº…', 'áº‡', 'áº‰', 'áº˜', 'Å´', 'áº€', 'áº‚', 'áº„', 'áº†', 'áºˆ', 'Æº'},
	'x': {'Ñ…', 'Ò³', 'Ó¿', 'ð±', 'ð‘¥', 'ð’™', 'ð”', 'ð”µ', 'ð•©', 'ð–', 'ð—‘', 'ð˜¹', 'ð™­', 'ðš¡', 'áº‹', 'áº', 'áºŠ', 'áºŒ'},
	'y': {'Ñƒ', 'Ò¯', 'Ó¯', 'Ã½', 'Ã¿', 'â²©', 'ð²', 'ð‘¦', 'ð’š', 'ð”‚', 'ð”¶', 'ð•ª', 'ð–ž', 'ð—’', 'ð˜º', 'ð™®', 'ðš¢', 'Å·', 'È³', 'áº', 'á»³', 'á»µ', 'á»·', 'á»¹', 'Å¶', 'Ã', 'Å¸', 'È²', 'áºŽ', 'á»²', 'á»´', 'á»¶', 'á»¸', 'Æ´'},
	'z': {'á´¢', 'Å¼', 'Åº', 'Å¾', 'ð³', 'ð‘§', 'ð’›', 'ð”ƒ', 'ð”·', 'ð•«', 'ð–Ÿ', 'ð—“', 'ð˜»', 'ð™¯', 'ðš£', 'Åº', 'Å¼', 'Å¾', 'áº‘', 'áº“', 'áº•', 'Å¹', 'Å»', 'Å½', 'áº', 'áº’', 'áº”', 'Æ¶', 'È¥', 'É€'},
}

func usage() {
	fmt.Fprintf(os.Stderr, "usage: %s [-i input] [-v] [-m max]\n", os.Args[0])
	fmt.Fprintf(os.Stderr, "  -i  input (letter or word)\n")
	fmt.Fprintf(os.Stderr, "  -v  verbose (show punycode)\n")
	fmt.Fprintf(os.Stderr, "  -m  max combinations (default 1000)\n")
	fmt.Fprintf(os.Stderr, "reads from stdin if no flags given\n")
}

func toPunycode(s string) string {
	encoded, err := idna.ToASCII(s)
	if err != nil {
		return ""
	}
	return encoded
}

func processInput(input string, maxCombinations int, verbose bool) {
	input = strings.TrimSpace(strings.ToLower(input))
	if len(input) == 0 {
		return
	}
	
	if len(input) == 1 {
		variants := homoglyphs[rune(input[0])]
		for _, v := range variants {
			if verbose {
				if p := toPunycode(string(v)); p != "" {
					fmt.Printf("%c \033[32mâ†’\033[0m %s\n", v, p)
				}
			} else {
				fmt.Printf("%c\n", v)
			}
		}
		return
	}
	
	chars := []rune(input)
	count := 0
	var generate func(int, string)
	generate = func(pos int, current string) {
		if count >= maxCombinations {
			return
		}
		if pos == len(chars) {
			if verbose {
				if p := toPunycode(current); p != "" {
					fmt.Printf("%s â†’ %s\n", current, p)
					count++
				}
			} else {
				fmt.Println(current)
				count++
			}
			return
		}
		
		char := chars[pos]
		generate(pos+1, current+string(char))
		
		if variants := homoglyphs[char]; variants != nil {
			for _, v := range variants {
				generate(pos+1, current+string(v))
			}
		}
	}
	generate(0, "")
}

func main() {
	var input = flag.String("i", "", "")
	var verbose = flag.Bool("v", false, "")
	var maxCombinations = flag.Int("m", 1000, "")
	
	flag.Usage = usage
	flag.Parse()
	
	if *input != "" {
		processInput(*input, *maxCombinations, *verbose)
		return
	}
	
	scanner := bufio.NewScanner(os.Stdin)
	for scanner.Scan() {
		processInput(scanner.Text(), *maxCombinations, *verbose)
	}
}
